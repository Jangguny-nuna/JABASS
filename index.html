<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Boom Boom Bass</title>
  <style>
    @font-face {
      font-family: 'DungGeunMo';
      src: url('./fonts/DungGeunMo.woff2') format('woff2'),
           url('./fonts/DungGeunMo.woff') format('woff'),
           url('./fonts/DungGeunMo.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    @font-face {
      font-family: 'HakgyoansimAllimjangTTF-B';
      src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimAllimjangTTF-B.woff2') format('woff2');
      font-weight: 700;
      font-style: normal;
    }

    body {
      background-color: #000;
      color: #fff;
      font-family: 'DungGeunMo', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      text-align: center;
    }

    h1 { font-size: 1.8rem; margin: 2rem 0 1rem; }

    #noteDisplay {
      font-size: 5rem;
      font-weight: bold;
      margin: 0.5rem 0;
      color: #00ffff;
      font-family: 'HakgyoansimAllimjangTTF-B', sans-serif;
    }

    .string-label { font-size: 2rem; color: #00ffff; font-weight: bold; font-family: sans-serif; }

    .timer-label { font-size: 1.5rem; color: #ffd700; font-weight: bold; margin-bottom: 0.5rem; }

    .menu button, .type-menu button, #pauseBtn, #startBtn {
      font-family: 'DungGeunMo';
      background-color: #333;
      color: #fff;
      border: 1px solid #777;
      padding: 0.4rem 0.7rem;
      border-radius: 6px;
      cursor: pointer;
    }

    .menu button.active, .type-menu button.active { background-color: #00aaff; color: #000; }

    .settings {
      display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 1rem;
    }

    .settings select, .settings input[type="number"] {
      height: 2.2rem; line-height: 2.2rem; font-size: 1rem; box-sizing: border-box; padding: 0 0.4rem; text-align: center;
    }

    input[type="number"], select {
      font-family: 'DungGeunMo'; background-color: #333; color: #fff; border: 1px solid #777; border-radius: 6px;
    }

    #pauseBtn.paused { background-color: #555; }

    .type-menu { display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; margin-bottom: 1rem; }

    .footer { font-size: 0.8rem; color: #999; margin-top: 2rem; }

    :root { --cat-shift: -80px; }
    .ascii-cat {
      font-family: 'DungGeunMo'; font-size: 20px; color: #FFFFFF; white-space: pre; text-align: center; line-height: 1;
      display: block; transform: translateY(var(--cat-shift)) scale(1); transition: transform 0.5s ease, opacity 0.5s ease;
    }
    .disappear { transform: translateY(var(--cat-shift)) scale(0); opacity: 0; }

    #pauseBtn, #startBtn {
      font-family: 'DungGeunMo'; background-color: #333; color: #fff; border: 1px solid #777; border-radius: 6px;
      font-size: 1rem; height: 2.2rem; line-height: 1.2; box-sizing: border-box;
    }

    #secInput { width: 60px; }
    #bpmInput { width: 80px; }
  </style>
</head>
<body>
  <h1 id="resetBtn" style="font-size: 1.2rem; margin-top: 1rem;">ğŸ¸</h1>
  <h1>ğŸ€BASS ì§€íŒ ì •ë³µí•˜ê¸°!ğŸ€</h1>

  <!-- Settings -->
  <div class="settings" id="settingsPanel">
    <select onchange="setMode(this.value)" id="modeSelect">
      <option value="chord">7th Chord</option>
      <option value="note" selected>Note</option>
    </select>

    <select id="timingModeSelect" onchange="setTimingMode(this.value)" style="width:70px;">
      <option value="sec" selected>ì´ˆ</option>
      <option value="bpm">BPM</option>
    </select>

    <div id="secControls">
      <input type="number" id="secInput" value="10" min="1" max="120" step="1"
             inputmode="numeric" pattern="[0-9]*" oninput="onSecChanged()">
    </div>

    <div id="bpmControls" style="display:none; gap:8px; align-items:center;">
      <input type="number" id="bpmInput" value="60" min="20" max="300" step="1"
             inputmode="numeric" pattern="[0-9]*" oninput="onBPMChanged()">
      <span>BPM</span>
      <span id="bpmPreview" style="align-self:center;">â‰ˆ 8ë°• â†’ 8.0ì´ˆ</span>
    </div>

    <button id="pauseBtn">||</button>
    <button id="startBtn">ì‹œì‘í•˜ê¸°</button>
  </div>

  <div class="string-label" id="stringLabel"></div>
  <div id="noteDisplay"></div>
  <div class="timer-label" id="timerLabel"></div>

  <!-- ë©”ë‰´ ì˜ì—­ -->
  <div class="type-menu" id="typeMenu"></div>
  <div class="type-menu" id="numberMenu"></div>
  <div class="type-menu" id="chordMenu"></div>

  <div class="ascii-wrapper">
    <div class="ascii-cat">
       _______
       /       \
       | PLAY!! |
        \_______/
           \
            /\_/\
           ( o.o )
          > ^ <
    </div>
  </div>

  <div class="footer">made by. PJA ğŸ¸</div>

  <script>
    // ====== ìƒíƒœ ======
    let intervalId;           // ì´ˆ ëª¨ë“œ setInterval
    let bpmIntervalId;        // (ì •ë¦¬ìš©) ê¸°ì¡´ ì¸í„°ë²Œ ì•„ì´ë””
    let bpmTimerId = null;    // BPM setTimeout ë£¨í”„
    let isPaused = false;
    let intervalSec = 10;
    let remainingTime = intervalSec;
    let started = false;
    let beatCount = 0;

    const noteTypes = ['#', 'â™­'];
    const chordTypes = ['M7', 'm7', '7', 'dim7', 'm7â™­5'];

    // ====== ì˜¤ë””ì˜¤ (ëŠê¹€ ë°©ì§€: í•˜ë‚˜ì˜ AudioContext ì¬ì‚¬ìš©) ======
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playBeep(high=false) {
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = "sine";
      osc.frequency.setValueAtTime(high ? 1200 : 880, audioCtx.currentTime);
      gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.start();
      osc.stop(audioCtx.currentTime + 0.1);
    }

    // ====== ì…ë ¥ í•¸ë“¤ëŸ¬ ======
    function onSecChanged() {
      intervalSec = Math.max(1, parseInt(document.getElementById("secInput").value,10) || 1);
      remainingTime = intervalSec; // í‘œì¤€í™”
    }
    function onBPMChanged() {
      let bpm = parseInt(document.getElementById("bpmInput").value,10) || 60;
      document.getElementById("bpmPreview").textContent = `â‰ˆ 8ë°• â†’ ${(8*60/bpm).toFixed(1)}ì´ˆ`;
    }

    function togglePause() {
      isPaused = !isPaused;
      const btn = document.getElementById("pauseBtn");
      btn.classList.toggle("paused", isPaused);
      btn.textContent = isPaused ? "âµ" : "||";
    }

    function setMode(mode) {
      if (!started) return;
      renderMenus(mode);
    }

    function clearBpmTimers() {
      clearInterval(bpmIntervalId);
      bpmIntervalId = null;
      if (bpmTimerId) {
        clearTimeout(bpmTimerId);
        bpmTimerId = null;
      }
    }

    function setTimingMode(value) {
      clearInterval(intervalId);
      clearBpmTimers();

      if (value === "bpm") {
        document.getElementById("secControls").style.display = "none";
        document.getElementById("bpmControls").style.display = "flex";
        if (started) {
          const bpm = parseInt(document.getElementById("bpmInput").value, 10) || 60;
          startBPM(bpm, { immediate: true }); // ì²« ë°•ì ì¦‰ì‹œ ì‹¤í–‰(ìƒˆë¬¸ì œ+GO+ë†’ì€ìŒ)
        }
      } else {
        document.getElementById("secControls").style.display = "block";
        document.getElementById("bpmControls").style.display = "none";
        if (started) {
          remainingTime = intervalSec;
          startSecTimer(); // ë‚´ë¶€ì—ì„œ ìƒˆë¬¸ì œ+GO ì²˜ë¦¬
        }
      }
    }

    function begin() {
      if (started) return;
      started = true;

      // ê³ ì–‘ì´ í‡´ì¥
      const catBox = document.querySelector('.ascii-cat');
      if (catBox) {
        catBox.classList.add('disappear');
        setTimeout(() => { catBox.style.display = 'none'; }, 500);
      }

      // íŒ¨ìŠ¤í•˜ê¸°ë¡œ ë³€ê²½
      const startBtn = document.getElementById("startBtn");
      startBtn.textContent = "íŒ¨ìŠ¤í•˜ê¸°";
      startBtn.removeEventListener("click", begin);
      startBtn.addEventListener("click", () => {
        if (document.getElementById("timingModeSelect").value === "bpm") {
          clearBpmTimers();
          const bpm = parseInt(document.getElementById("bpmInput").value, 10) || 60;
          startBPM(bpm, { immediate: true }); // í…€ ì—†ì´ ë°”ë¡œ ì²« ë°•ì
        } else {
          clearInterval(intervalId);
          remainingTime = intervalSec;
          startSecTimer();
        }
      });

      renderMenus(document.getElementById("modeSelect").value);

      // ìµœì´ˆ ì‹œì‘
      if (document.getElementById("timingModeSelect").value === "bpm") {
        const bpm = parseInt(document.getElementById("bpmInput").value, 10) || 60;
        startBPM(bpm, { immediate: true });
      } else {
        remainingTime = intervalSec;
        startSecTimer();
      }
    }

    // ====== ì´ˆ ëª¨ë“œ íƒ€ì´ë¨¸ ======
    function startSecTimer() {
      clearInterval(intervalId);
      remainingTime = intervalSec;

      // ì‚¬ì´í´ ì‹œì‘: ìƒˆ ë¬¸ì œ + GO! + ë†’ì€ìŒ
      showNext();
      document.getElementById("timerLabel").textContent = "GO!";
      playBeep(true);

      intervalId = setInterval(() => {
        if (isPaused) return;

        if (remainingTime > 0) {
          document.getElementById("timerLabel").textContent = `${remainingTime}ì´ˆ ë‚¨ìŒ`;
          playBeep(false);
          remainingTime--;
        } else {
          // 0 ë˜ë©´ í…€ ì—†ì´ ì¦‰ì‹œ ë‹¤ìŒ ì‚¬ì´í´ ì‹œì‘
          showNext();
          document.getElementById("timerLabel").textContent = "GO!";
          playBeep(true);
          remainingTime = intervalSec;
        }
      }, 1000);
    }

    // ====== BPM ëª¨ë“œ (setTimeout ë£¨í”„ / ì²« ë°•ì ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥) ======
    function startBPM(bpm, { immediate = false } = {}) {
      clearBpmTimers();
      beatCount = 0;
      const interval = 60000 / bpm;

      const tick = () => {
        if (isPaused) { bpmTimerId = setTimeout(tick, 100); return; } // ì¼ì‹œì •ì§€ ì‹œ ì§„í–‰ ë©ˆì¶”ê³  í´ë§

        beatCount++;
        const isFirst = (beatCount === 1);

        playBeep(isFirst);

        if (isFirst) {
          // ì²« ë°•ì: ìƒˆ ë¬¸ì œ + GO!
          showNext();
          document.getElementById("timerLabel").textContent = "GO!";
        } else if (beatCount <= 9) {
          // 2~9ë°•: 1/8 ~ 8/8
          document.getElementById("timerLabel").textContent = `${beatCount - 1}/8`;
        }

        // 9ë°• ë â†’ ë‹¤ìŒ ì‚¬ì´í´(ë‹¤ìŒ tickì—ì„œ ë‹¤ì‹œ 1ë¶€í„°)
        if (beatCount >= 9) beatCount = 0;

        bpmTimerId = setTimeout(tick, interval);
      };

      if (immediate) tick();
      else bpmTimerId = setTimeout(tick, interval);
    }

    // ====== ë‹¨ì¶•í‚¤ ======
    document.addEventListener('keydown', (e) => {
      const tag = (e.target.tagName || '').toLowerCase();
      if (tag === 'input' || tag === 'textarea' || tag === 'select') return;

      if (e.code === 'Enter' && started) {
        e.preventDefault();
        if (document.getElementById("timingModeSelect").value === "bpm") {
          const bpm = parseInt(document.getElementById("bpmInput").value, 10) || 60;
          startBPM(bpm, { immediate: true }); // ì¦‰ì‹œ ì²« ë°•ì
        } else {
          clearInterval(intervalId);
          remainingTime = intervalSec;
          startSecTimer();
        }
      }
      if (e.code === 'Space' || e.key === ' ') {
        e.preventDefault();
        togglePause();
      }
    });

    // ====== UI ë³´ì¡° ======
    function renderMenus(mode) {
      document.getElementById("typeMenu").innerHTML = '';
      document.getElementById("numberMenu").innerHTML = '';
      document.getElementById("chordMenu").innerHTML = '';

      if (mode === 'note') {
        noteTypes.forEach(type => {
          const btn = document.createElement('button');
          btn.textContent = type;
          btn.onclick = () => btn.classList.toggle('active');
          document.getElementById("typeMenu").appendChild(btn);
        });

        for (let i=1;i<=6;i++){
          const btn = document.createElement('button');
          btn.textContent = i+"ë²ˆ";
          btn.onclick = () => btn.classList.toggle('active');
          document.getElementById("numberMenu").appendChild(btn);
        }

      } else if (mode === 'chord') {
        chordTypes.forEach(type => {
          const btn = document.createElement('button');
          btn.textContent = type;
          btn.classList.add('active');
          btn.onclick = () => btn.classList.toggle('active');
          document.getElementById("chordMenu").appendChild(btn);
        });
      }
    }

    function showNext() {
      const mode = document.getElementById("modeSelect").value;
      const baseNotes = ['C','D','E','F','G','A','B'];
      let notes = [...baseNotes];

      const sharpActive = document.querySelector('#typeMenu button:nth-child(1)')?.classList.contains('active');
      const flatActive = document.querySelector('#typeMenu button:nth-child(2)')?.classList.contains('active');
      baseNotes.forEach(n=>{
        if (sharpActive) notes.push(n+'#');
        if (flatActive) notes.push(n+'â™­');
      });

      if (mode === "note") {
        const activeNums = Array.from(document.querySelectorAll('#numberMenu button.active')).map(b=>b.textContent);
        if (activeNums.length === 0) {
          document.getElementById("noteDisplay").textContent = notes[Math.floor(Math.random()*notes.length)];
        } else {
          const randNum = activeNums[Math.floor(Math.random()*activeNums.length)];
          const randNote = notes[Math.floor(Math.random()*notes.length)];
          document.getElementById("noteDisplay").textContent = `${randNum} ${randNote}`;
        }
      } else {
        const activeTypes = Array.from(document.querySelectorAll('#chordMenu button.active')).map(b=>b.textContent);
        if (activeTypes.length === 0) return;
        const randChord = baseNotes[Math.floor(Math.random()*baseNotes.length)];
        const randType = activeTypes[Math.floor(Math.random()*activeTypes.length)];
        document.getElementById("noteDisplay").textContent = randChord+randType;
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      document.getElementById("resetBtn").addEventListener("click", () => location.reload());
      document.getElementById("startBtn").addEventListener("click", begin);
      document.getElementById("pauseBtn").addEventListener("click", togglePause);
      onBPMChanged();
    });
// ====== ëœë¤ í¬ë ˆë”§ ======
const commonCredits = [
  "Made by. PJA ğŸ¸",
  "Bass is Life ğŸ¶",
  "GO! â†’ Practice Never Stops ğŸ’ª",
  "Keep Calm and Play Bass ğŸ¤˜",
  "Just One More Note... ğŸµ",
  "Practice Makes Perfect ğŸ’¯",
  "Groove First, Speed Later ğŸ¥",
  "Stay in the Pocket ğŸ¼",
  "Music = Magic âœ¨",
  "Play Loud, Play Proud ğŸ”Š",
  "Rhythm is the Soul of Life â¤ï¸",
  "No Treble, Only Bass ğŸ”¥",
  "One Bassline a Day Keeps the Doctor Away ğŸ©º",
  "From Low End Comes Big Power âš¡",
  "Bassists Do It Deeper ğŸŒŠ",
  "Lock In with the Drummer ğŸ¥",
  "Turn Up the Low End ğŸ“¡",
  "Your Groove is Showing ğŸ˜‰",
  "Fingers > Pick? Debate Forever ğŸ¤”",
  "Pluck. Slap. Pop. Repeat. ğŸ”",
"í–‰ë³µí•˜ì„¸ìš”ğŸ€",
"ë²„ê±°ëŠ” ì¹˜ì¦ˆë²„ê±°ğŸ”",
"ğŸ¦œğŸ•ğŸ¦•",
"ì¬ê·œì•„ê°€ ì—´ì‹¬íˆ ë§Œë“¤ì—ˆìŒğŸ†",
"ë² ì´ìŠ¤ë¡œ ì§€êµ¬ì •ë³µğŸ‘½"

];

const rareCredits = [
  "powered by ì¥êµ°ì´ ğŸ±",
  "ì¬ê·œê³ ë˜ê°€ ì‘ì›í•œë‹¤ ğŸŒŠğŸ‹",
  "âœ¨ Secret Bass Master âœ¨",
  "You've Found the Hidden Groove ğŸ•µï¸â€â™‚ï¸",
  "Bass Wizard Unlocked ğŸ§™â€â™‚ï¸",
  "ğŸ¾ ì¥êµ°ì´ê°€ ì˜¤ëŠ˜ë„ ì§€ì¼œë³¸ë‹¤ ğŸ‘€",
  "ğŸŒŒ ì¬ê·œê³ ë˜: ê·œë­~ ìì•„ìˆë‹¤â„¢",
  "ğŸ¥¢ ê¹€ì¹˜ë³¶ìŒë°¥ ë¨¹ê³  ë” ì—°ìŠµí•´ë¼",
  "ğŸ¸ Legendary Bassist Mode Activated",
  "ğŸš€ To Infinity... and Bass!",
  "ğŸ‰ ì´ë¬´ê¸°ê°€ ë„ ì§€ì¼œë³´ê³  ìˆë‹¤",
  "ğŸ¤ ë³´ì»¬ ì—†ìœ¼ë©´ ìš°ë¦¬ë„ ë…¸ë˜í•œë‹¤",
  "ğŸ€ Lucky Note Discovered!",
  "ğŸ”® Mystic Groove Detected",
  "ğŸ§ Play It Again... Louder!",
  "ğŸŒ™ Midnight Bass Practice Vibes",
  "ğŸ” ë²„ê±°ì²˜ëŸ¼ ìŒ“ì•„ì˜¬ë¦° ë² ì´ìŠ¤ ë¼ì¸",
  "ğŸŸ ë¯¸ë¥´ê°€ í—¤ì—„ì¹˜ë©° ì‘ì› ì¤‘",
  "ğŸ”¥ Bass God Mode: ON",
  "ğŸ® Cheat Code Unlocked: B-A-S-S"
];

const footer = document.querySelector(".footer");

// 10% í™•ë¥ ë¡œ í¬ê·€ ë©˜íŠ¸
if (Math.random() < 0.1) {
  footer.textContent = rareCredits[Math.floor(Math.random() * rareCredits.length)];
} else {
  footer.textContent = commonCredits[Math.floor(Math.random() * commonCredits.length)];
}

  </script>
</body>
</html>
