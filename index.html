
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Boom Boom Bass</title>
  <style>
    @font-face {
      font-family: 'DungGeunMo';
      src: url('./fonts/DungGeunMo.woff2') format('woff2'),
           url('./fonts/DungGeunMo.woff') format('woff'),
           url('./fonts/DungGeunMo.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    @font-face {
      font-family: 'HakgyoansimAllimjangTTF-B';
      src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimAllimjangTTF-B.woff2') format('woff2');
      font-weight: 700;
      font-style: normal;
    }

    body {
      background-color: #000;
      color: #fff;
      font-family: 'DungGeunMo', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      text-align: center;
    }

    h1 {
      font-size: 1.8rem;
      margin: 2rem 0 1rem;
    }

    #noteDisplay {
      font-size: 5rem;
      font-weight: bold;
      margin: 0.5rem 0;
      color: #00ffff;
      font-family: 'HakgyoansimAllimjangTTF-B', sans-serif;
    }

    .string-label {
      font-size: 2rem;
      color: #00ffff;
      font-weight: bold;
      font-family: sans-serif;
    }

    .timer-label {
      font-size: 1.2rem;
      color: #ffd700;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .menu button, .type-menu button, .mode-menu button, #pauseBtn, #startBtn {
      font-family: 'DungGeunMo';
      background-color: #333;
      color: #fff;
      border: 1px solid #777;
      padding: 0.4rem 0.7rem;
      border-radius: 6px;
      cursor: pointer;
    }

    .menu button.active,
    .type-menu button.active {
      background-color: #00aaff;
      color: #000;
    }

    .settings {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 1rem;
    }

    input[type="number"], select {
      font-family: 'DungGeunMo';
      background-color: #333;
      color: #fff;
      border: 1px solid #777;
      padding: 0.4rem;
      border-radius: 6px;
    }

    #pauseBtn.paused {
      background-color: #555;
    }

    .type-menu {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .footer {
      font-size: 0.8rem;
      color: #999;
      margin-top: 2rem;
    }
.menu-btn {
  font-family: 'DungGeunMo';
  background-color: #333;
  color: #fff;
  border: 1px solid #777;
  padding: 0.4rem 0.7rem;
  border-radius: 6px;
  cursor: pointer;
}

  :root {
  --cat-shift: -80px; /* ìŒìˆ˜ = ìœ„ë¡œ, ì–‘ìˆ˜ = ì•„ë˜ë¡œ */
}

.ascii-cat {
  font-family: 'DungGeunMo';
  font-size: 20px;
  color: #FFFFFF;
  white-space: pre;
  text-align: center;
  line-height: 1;
  display: block;
  transform: translateY(var(--cat-shift)) scale(1);
  transition: transform 0.5s ease, opacity 0.5s ease;
}

.disappear {
  transform: translateY(var(--cat-shift)) scale(0);
  opacity: 0;
}
#pauseBtn,
#startBtn,
.menu-btn {
  font-family: 'DungGeunMo';
  background-color: #333;
  color: #fff;
  border: 1px solid #777;
  padding: 0.4rem 0.7rem;
  border-radius: 6px;
  font-size: 1rem;
  height: 2.2rem; /* ğŸ”¥ ê³ ì • ë†’ì´ */
  line-height: 1.2;
  box-sizing: border-box;
}

  </style>
</head>
<body>
  <h1 id="resetBtn" style="font-size: 1.2rem; margin-top: 1rem;">ğŸ¸</h1>
  <h1>ğŸ€BASS ì§€íŒ ì •ë³µí•˜ê¸°!ğŸ€</h1>

  <div class="settings" id="settingsPanel">
    <select onchange="setMode(this.value)" id="modeSelect">
      <option value="chord">7th Chord</option>
      <option value="note" selected>Note</option>
    </select>

    <div>
      <button class="menu-btn" onclick="adjustInterval(-1)">-</button>
      <span id="intervalValue">10</span>ì´ˆ
      <button class="menu-btn" onclick="adjustInterval(1)">+</button>
    </div>

    <button id="pauseBtn" onclick="togglePause()">||</button>
    <button id="startBtn" onclick="begin()">ì‹œì‘í•˜ê¸°</button>
  </div>

  <div class="string-label" id="stringLabel"></div>
  <div id="noteDisplay"></div>
  <div class="timer-label" id="timerLabel"></div>
  <div class="type-menu" id="typeMenu"></div>
  <div class="type-menu" id="stringMenu"></div>
  <div class="type-menu" id="chordMenu"></div>

  <div class="ascii-wrapper">
    <div class="ascii-cat">
       _______
       /       \
       | PLAY!! |
        \_______/ 
           \   
            /\_/\  
           ( o.o ) 
          > ^ <
    </div>
  </div>

  <div class="footer">made by. PJA ğŸ¸</div>
<script>
  let intervalId;
  let isPaused = false;
  let intervalSec = 10;
  let remainingTime = intervalSec;
  let started = false;

  const noteTypes = ['#', 'â™­'];
  const chordTypes = ['M7', 'm7', '7', 'dim7', 'm7â™­5'];

  // ì´ˆê¸°ê°€ë™: ë¦¬ì…‹ ë²„íŠ¼ ì—°ê²°
  window.addEventListener('DOMContentLoaded', () => {
    const resetH1 = document.getElementById('resetBtn');
    if (resetH1) resetH1.addEventListener('click', resetGame);
  });

  function adjustInterval(val) {
    intervalSec = Math.max(1, intervalSec + val);
    document.getElementById("intervalValue").textContent = intervalSec;
    remainingTime = intervalSec; // ì„¤ì • ë³€ê²½ ì‹œ ê¸°ì¤€ ì—…ë°ì´íŠ¸
  }

  function togglePause() {
    isPaused = !isPaused;
    const btn = document.getElementById("pauseBtn");
    btn.classList.toggle("paused", isPaused);
    btn.textContent = isPaused ? "âµ" : "||";
  }

  function setMode(mode) {
    renderMenus(mode);
  }

  function begin() {
    if (started) return;
    started = true;

    const catBox = document.querySelector('.ascii-cat');
    const startBtn = document.getElementById('startBtn');

    // ê³ ì–‘ì´ í‡´ì¥ ì• ë‹ˆë©”ì´ì…˜
    if (catBox) {
      catBox.classList.add('disappear');
      void catBox.offsetWidth;
      setTimeout(() => { catBox.style.display = 'none'; }, 500);
    }

    // 'ì‹œì‘í•˜ê¸°' â†’ 'íŒ¨ìŠ¤í•˜ê¸°'ë¡œ êµì²´ (id ìœ ì§€)
    startBtn.textContent = 'íŒ¨ìŠ¤í•˜ê¸°';
    const newStartBtn = startBtn.cloneNode(true);
    newStartBtn.id = 'startBtn';
    startBtn.parentNode.replaceChild(newStartBtn, startBtn);

    // íŒ¨ìŠ¤: íƒ€ì´ë¨¸ ë¦¬ì…‹ í›„ ë‹¤ìŒ ë¬¸ì œ
    newStartBtn.addEventListener('click', () => {
      remainingTime = intervalSec;
      showNext();
      newStartBtn.blur(); // ìŠ¤í˜ì´ìŠ¤ê°€ í´ë¦­ìœ¼ë¡œ ì˜¤ì¸ë˜ëŠ” ê±° ë°©ì§€
    });
    // ë²„íŠ¼ í¬ì»¤ìŠ¤ ìƒíƒœì˜ ìŠ¤í˜ì´ìŠ¤ ê¸°ë³¸ë™ì‘ ë§‰ê¸°
    newStartBtn.addEventListener('keydown', (e) => {
      if (e.code === 'Space' || e.key === ' ') e.preventDefault();
    });
    newStartBtn.addEventListener('keyup', (e) => {
      if (e.code === 'Space' || e.key === ' ') e.preventDefault();
    });

    // ì „ì—­ ë‹¨ì¶•í‚¤: Enter=íŒ¨ìŠ¤, Space=ì¼ì‹œì •ì§€/ì¬ìƒ
    document.addEventListener('keydown', function(e) {
      const tag = (e.target.tagName || '').toLowerCase();
      if (tag === 'input' || tag === 'textarea' || tag === 'select') return;

      if (e.code === 'Enter' && started) {
        remainingTime = intervalSec;
        showNext();
        return;
      }

      if (e.code === 'Space' || e.key === ' ') {
        e.preventDefault(); // ìŠ¤í¬ë¡¤/ë²„íŠ¼í´ë¦­ ë°©ì§€
        togglePause();
      }
    });

    // ìµœì´ˆ ë Œë” + íƒ€ì´ë¨¸ ì‹œì‘
    setTimeout(() => {
      renderMenus(document.getElementById("modeSelect").value);
      clearInterval(intervalId);
      remainingTime = intervalSec;
      showNext();
      intervalId = setInterval(() => {
        if (!isPaused) {
          remainingTime--;
          document.getElementById("timerLabel").textContent = `${remainingTime}ì´ˆ ë‚¨ìŒ`;
          if (remainingTime <= 0) {
            showNext();
            remainingTime = intervalSec;
          }
        }
      }, 1000);
    }, 500);
  }

  // ğŸ¸ ëˆ„ë¥´ë©´ ì™„ì „ ì´ˆê¸°í™”
  function resetGame() {
    // íƒ€ì´ë¨¸ ì¢…ë£Œ/ìƒíƒœ ì´ˆê¸°í™”
    clearInterval(intervalId);
    isPaused = false;
    started = false;
    remainingTime = intervalSec;

    // UI ì´ˆê¸°í™”
    document.getElementById("noteDisplay").textContent = '';
    document.getElementById("stringLabel").textContent = '';
    document.getElementById("timerLabel").textContent = '';

    // ë©”ë‰´/ë²„íŠ¼ ì´ˆê¸°í™”
    document.getElementById("typeMenu").innerHTML = '';
    document.getElementById("stringMenu").innerHTML = '';
    document.getElementById("chordMenu").innerHTML = '';

    // ëª¨ë“œ ì…€ë ‰íŠ¸ ê¸°ë³¸ê°’(ì›í•˜ë©´ ìœ ì§€í•´ë„ ë¨)
    const modeSel = document.getElementById("modeSelect");
    if (modeSel) modeSel.value = 'note';

    // ì‹œì‘ ë²„íŠ¼ ì›ë³µ: ìƒˆ ë…¸ë“œë¡œ ê°ˆì•„ë¼ìš°ê³  begin ì—°ê²°
    const curStart = document.getElementById('startBtn');
    if (curStart) {
      const freshStart = curStart.cloneNode(true);
      freshStart.id = 'startBtn';
      freshStart.textContent = 'ì‹œì‘í•˜ê¸°';
      curStart.parentNode.replaceChild(freshStart, curStart);
      freshStart.addEventListener('click', begin);
    }

    // ì¼ì‹œì •ì§€ ë²„íŠ¼ í‘œì‹œ ì›ë³µ
    const pauseBtn = document.getElementById("pauseBtn");
    if (pauseBtn) {
      pauseBtn.classList.remove('paused');
      pauseBtn.textContent = "||";
      pauseBtn.blur();
    }

    // ê³ ì–‘ì´ ë‹¤ì‹œ ë“±ì¥
    const catBox = document.querySelector('.ascii-cat');
    if (catBox) {
      catBox.style.display = 'block';
      catBox.classList.remove('disappear');
      // ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ ì‚´ì§ ë¦¬ì…‹í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
      // void catBox.offsetWidth;
    }
  }

  function renderMenus(mode) {
    document.getElementById("typeMenu").innerHTML = '';
    document.getElementById("stringMenu").innerHTML = '';
    document.getElementById("chordMenu").innerHTML = '';

    if (mode === 'note') {
      // # / â™­ í† ê¸€
      noteTypes.forEach(type => {
        const btn = document.createElement('button');
        btn.textContent = type;
        btn.onclick = () => btn.classList.toggle('active');
        document.getElementById("typeMenu").appendChild(btn);
      });

      // í˜„ ìˆ˜ ì„ íƒ (ë‹¨ì¼ ì„ íƒ)
      ['4í˜„', '5í˜„', '6í˜„'].forEach(label => {
        const btn = document.createElement('button');
        btn.textContent = label;
        btn.onclick = () => {
          document.querySelectorAll('#stringMenu button').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        };
        document.getElementById("stringMenu").appendChild(btn);
      });

    } else if (mode === 'chord') {
      chordTypes.forEach(type => {
        const btn = document.createElement('button');
        btn.textContent = type;
        btn.classList.add('active'); // ê¸°ë³¸ í™œì„±
        btn.onclick = () => btn.classList.toggle('active');
        document.getElementById("chordMenu").appendChild(btn);
      });
    }
  }

  function showNext() {
    const mode = document.getElementById("modeSelect").value;
    const baseNotes = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
    let notes = [...baseNotes];

    const sharpActive = document.querySelector('#typeMenu button:nth-child(1)')?.classList.contains('active');
    const flatActive = document.querySelector('#typeMenu button:nth-child(2)')?.classList.contains('active');

    // ì¤‘ë³µ ì—†ì´ í™•ì¥
    baseNotes.forEach(n => {
      if (sharpActive) notes.push(n + '#');
      if (flatActive) notes.push(n + 'â™­');
    });

    if (mode === "note") {
      const stringBtns = Array.from(document.querySelectorAll('#stringMenu button.active'));
      const selectedStrings = stringBtns.map(btn => btn.textContent);
      let stringRange = [];

      if (selectedStrings.includes('4í˜„')) stringRange.push(...['1ë²ˆ', '2ë²ˆ', '3ë²ˆ', '4ë²ˆ']);
      if (selectedStrings.includes('5í˜„')) stringRange.push(...['1ë²ˆ', '2ë²ˆ', '3ë²ˆ', '4ë²ˆ', '5ë²ˆ']);
      if (selectedStrings.includes('6í˜„')) stringRange.push(...['1ë²ˆ', '2ë²ˆ', '3ë²ˆ', '4ë²ˆ', '5ë²ˆ', '6ë²ˆ']);

      const randNote = notes[Math.floor(Math.random() * notes.length)];

      if (stringRange.length === 0) {
        document.getElementById("stringLabel").textContent = '';
        document.getElementById("noteDisplay").textContent = `${randNote}`;
      } else {
        const randString = stringRange[Math.floor(Math.random() * stringRange.length)];
        document.getElementById("noteDisplay").textContent = `${randString}, ${randNote}`;
        document.getElementById("stringLabel").textContent = '';
      }

    } else {
      const activeTypes = Array.from(document.querySelectorAll('#chordMenu button.active')).map(b => b.textContent);
      if (activeTypes.length === 0) return;
      const randChord = baseNotes[Math.floor(Math.random() * baseNotes.length)];
      const randType = activeTypes[Math.floor(Math.random() * activeTypes.length)];
      document.getElementById("noteDisplay").textContent = randChord + randType;
      document.getElementById("stringLabel").textContent = '';
    }

    // í˜„ì¬ ë‚¨ì€ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë¼ë²¨ í‘œê¸°
    document.getElementById("timerLabel").textContent = `${remainingTime}ì´ˆ ë‚¨ìŒ`;
  }
</script>
</body>
</html>
